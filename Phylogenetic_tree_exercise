#Κατασκευή φυλογενετικού δέντρου από διάφορα αρχεία fasta. 
#Βήματα : 
#1) Τοποθέτηση όλων των αρχείων σε 1,
#2) Στοίχηση των αλληλουχιών και τροποποίηση των ονοματων,
#3) Φυλογενετική ανάλυση των αλληλουχιών βασισμένη στην Μέγιστη Πιθανότητα,
#4) Οπτικοποίηση του δέντου.

#Εντολές:

#Κατεβάζω mafft(msa) και raxmlHPc
sudo apt update
git clone https://github.com/stamatak/standard-RAxML.git
cd standard-RAxML

#για να τρέxει αυτό το αρχείο γιατί πριν δεν ήταν σε εκτελέσιμη μορφή
make -f Makefile.gcc   


sudo apt-get install mafft  
#ή sudo apt install raxml


#Πάω στον κατάλληλο κατάλογο
cd RAxML/Analysis/fasta_arxeia

#Δημιουργώ με την εντολή cat ενα αρχείο fasta  το οποίο περιέχει όλες τις αλληλουχίες μαζί
cat *.fasta > combined.fasta

#Με την χρήση του mafft κάνω στοίχιση των αλληλουχιών στο combined αρχείο
mafft --auto combined.fasta > aligned_sequences.fasta

#Με την εντολήν sed μετατρέπω τα ονόματα των αλληλουχιών (ότι αρχίζει απο ">......") 
#ώστε όπου υπάρχει κένο να βάλω ένα _.
sed 's/ /_/g' aligned_sequences.fasta > modified_aligned_sequences.fasta

#Με την εντολή raxmlHPC 
raxmlHPC -s modified_aligned_sequences.fasta -n firstrun -m GTRGAMMA -p 12345

#raxmlHPC: Αυτό είναι το εκτελέσιμο αρχείο του RAxML που εκτελεί την ανάλυση για την κατασκευή φυλογενετικών δέντρων.

#Με το -s δηλώνω το αρχείο εισόδου που περιέχει τις αλληλουχίες. 

#Με το -n καθορίζω το όνομα του αρχείου εξόδου (firstrun). 
#Το RAxML θα δημιουργήσει διάφορα αρχεία (όπως το δέντρο και τα logs) με αυτό το όνομα,
#αλλά με διαφορετικές επεκτάσεις (π.χ., .tre, .log, κλπ).

#Με το -m καθορίζω το μοντέλο εξέλιξης που θα χρησιμοποιηθεί για την ανάλυση (GTRGAMMA)
#GTR:όλες οι πιθανές μετατροπές μεταξύ των νουκλεοτιδίων (A, T, C, G).
#GAMMA:εκτίμηση της μεταβλητότητας της ταχύτητας εξέλιξης στις θέσεις του γονιδιώματος.

#Με το -p καθορίζει έναν τυχαίο αριθμό (12345) για την αρχικοποίηση των τυχαίων αριθμών στον υπολογισμό της μεθόδου bootstrap. 
#Στην περίπτωση που κάνω bootstrap analysis, 
#αυτός ο αριθμός χρησιμοποιείται για να διασφαλίσει την αναπαραγωγιμότητα των αποτελεσμάτων.
#Εγώ δεν έκανα, αλλα διάβασα οτι ειναί χρήσιμο γιατί σου δειχνεί την αξιοπιστία του δέντρου που βρήκες.

#http://etetoolkit.org/treeview/
#Σε αυτό το site βάζω το best_tree για οπτικοποίηση του δέντρου 
